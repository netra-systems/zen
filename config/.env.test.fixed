# Test Environment Configuration
# Used with docker-compose.unified.yml for running tests
# Activate with: COMPOSE_PROFILES=test docker-compose -f docker-compose.unified.yml --env-file .env.test up

# Environment
BUILD_ENV=test
ENVIRONMENT=test
NODE_ENV=test
LOG_LEVEL=ERROR

# Docker Images
BACKEND_IMAGE=netra-test-backend:latest
AUTH_IMAGE=netra-test-auth:latest
FRONTEND_IMAGE=netra-test-frontend:latest
BACKEND_DOCKERFILE=./docker/backend.Dockerfile
AUTH_DOCKERFILE=./docker/auth.Dockerfile
FRONTEND_DOCKERFILE=./docker/frontend.Dockerfile

# Service Names (for dependency resolution)
POSTGRES_HOST=test-postgres
REDIS_HOST=test-redis
CLICKHOUSE_HOST=test-clickhouse
AUTH_SERVICE_URL=http://test-auth:8081

# Database Configuration
POSTGRES_USER=test_user
POSTGRES_PASSWORD=test_pass
POSTGRES_DB=netra_test
POSTGRES_AUTH_METHOD=trust
POSTGRES_FSYNC=off
POSTGRES_SYNC_COMMIT=off
POSTGRES_FULL_PAGE_WRITES=off

# Redis Configuration
REDIS_AOF=no
REDIS_SAVE=
REDIS_MAX_MEMORY=512mb
REDIS_POLICY=allkeys-lru

# ClickHouse Configuration
CLICKHOUSE_USER=test_user
CLICKHOUSE_PASSWORD=test_pass
CLICKHOUSE_DB=netra_test_analytics
CLICKHOUSE_PORT=9000
CLICKHOUSE_LOG_LEVEL=error

# Port Allocation (Test)
TEST_POSTGRES_PORT=5434
TEST_REDIS_PORT=6381
TEST_CLICKHOUSE_HTTP_PORT=8125
TEST_CLICKHOUSE_TCP_PORT=9002
TEST_BACKEND_PORT=8001
TEST_AUTH_PORT=8082
TEST_FRONTEND_PORT=3001

# Resource Limits (Test - Minimal)
TEST_POSTGRES_MEMORY=256M
TEST_POSTGRES_CPU=0.3
TEST_REDIS_MEMORY=512M
TEST_REDIS_CPU=0.1
TEST_CLICKHOUSE_MEMORY=512M
TEST_CLICKHOUSE_CPU=0.2
TEST_BACKEND_MEMORY=2G
TEST_BACKEND_CPU=0.4
TEST_AUTH_MEMORY=1G
TEST_AUTH_CPU=0.25
TEST_FRONTEND_MEMORY=1G
TEST_FRONTEND_CPU=0.3

# Health Check Configuration (Fast for tests)
HEALTH_CHECK_INTERVAL=10s
HEALTH_CHECK_TIMEOUT=5s
HEALTH_CHECK_RETRIES=10
HEALTH_CHECK_START_PERIOD=20s

# Application Secrets (Test Only)
JWT_SECRET_KEY=test_jwt_secret_key_for_testing_only
SERVICE_SECRET=test_service_secret_for_testing_only
FERNET_KEY=test_fernet_key_for_testing_only_32chars
SECRET_KEY=test_secret_key_for_testing_only
AUTH_SERVICE_ID=test-auth-service

# Frontend Configuration
NEXT_PUBLIC_API_URL=http://test-backend:8000
NEXT_PUBLIC_AUTH_URL=http://test-auth:8081
NEXT_PUBLIC_WS_URL=ws://test-backend:8000

# Backend Configuration
BACKEND_WORKERS=2
WEB_CONCURRENCY=2
ENABLE_MEMORY_MONITORING=false
MEMORY_CHECK_INTERVAL=60
MEMORY_WARNING_THRESHOLD=90
MEMORY_CRITICAL_THRESHOLD=95

# Test Mode Settings
TEST_MODE=true
TESTING=1
AUTH_FAST_TEST_MODE=true