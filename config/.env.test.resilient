# Enhanced Test Configuration with Resilience Patterns for Issue #1278
# Provides graceful degradation during staging infrastructure failures
# Created for interim testing while VPC connector/Cloud SQL issues are resolved

ENVIRONMENT=test

# Infrastructure Resilience Settings
INFRASTRUCTURE_DEGRADED_MODE=true
CONNECTIVITY_RESILIENCE_ENABLED=true
STAGING_CONNECTIVITY_FALLBACK=true

# Service Mode Configuration with Fallbacks
REDIS_MODE=local
CLICKHOUSE_MODE=local
LLM_MODE=shared
DATABASE_MODE=local

# Local Test Database Configuration (Primary Fallback)
POSTGRES_HOST=localhost
POSTGRES_PORT=5435
POSTGRES_DB=test_db
POSTGRES_USER=test_user
POSTGRES_PASSWORD=test_password

# Staging Database Configuration (When Available)
STAGING_POSTGRES_HOST=10.52.0.3
STAGING_POSTGRES_PORT=5432
STAGING_POSTGRES_DB=netra_staging
STAGING_POSTGRES_USER=postgres
STAGING_POSTGRES_PASSWORD=staging_password

# Redis Configuration (Local Fallback)
REDIS_URL=redis://localhost:6382/0
REDIS_HOST=localhost
REDIS_PORT=6382
REDIS_PASSWORD=

# ClickHouse Configuration (Local Fallback)
CLICKHOUSE_URL=clickhouse://default:clickhouse@localhost:8126/default
CLICKHOUSE_HOST=localhost
CLICKHOUSE_HTTP_PORT=8126
CLICKHOUSE_TCP_PORT=9003
CLICKHOUSE_NATIVE_PORT=9003
CLICKHOUSE_DB=default
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=clickhouse

# Auth Service Configuration with Resilience
AUTH_SERVICE_URL=http://localhost:8083
AUTH_SERVICE_ENABLED=true
AUTH_ENABLED=true
AUTH_FALLBACK_MODE=true

# Staging Service URLs (When Available)
STAGING_BACKEND_URL=https://backend-staging-701982941522.us-central1.run.app
STAGING_API_URL=https://api.staging.netrasystems.ai
STAGING_WEBSOCKET_URL=wss://api.staging.netrasystems.ai/ws
STAGING_AUTH_URL=https://auth.staging.netrasystems.ai

# Security Keys - Test Environment
SERVICE_SECRET=test-secret-for-resilient-testing-32chars
SECRET_KEY=test-secret-key-for-session-middleware-32chars
JWT_SECRET_KEY=test-jwt-secret-key-for-resilient-containers-256
FERNET_KEY=test-fernet-key-for-encryption-32-base64-encoded=

# JWT Configuration
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# Google OAuth Test Configuration
GOOGLE_CLIENT_ID=test-client-id
GOOGLE_CLIENT_SECRET=test-client-secret
GOOGLE_OAUTH_CLIENT_ID_DEVELOPMENT=test-client-id
GOOGLE_OAUTH_CLIENT_SECRET_DEVELOPMENT=test-client-secret

# API Keys for Testing
GEMINI_API_KEY=test-gemini-key
ANTHROPIC_API_KEY=test-anthropic-key
OPENAI_API_KEY=test-openai-key

# LLM Configuration with Fallback
NETRA_REAL_LLM_ENABLED=false
TEST_USE_REAL_LLM=false
USE_REAL_LLM=false
ENABLE_REAL_LLM_TESTING=false
LLM_FALLBACK_MODE=true

# Service Status Flags
DEV_MODE_REDIS_ENABLED=true
DEV_MODE_CLICKHOUSE_ENABLED=true
DEV_MODE_LLM_ENABLED=false

# Test Features
ALLOW_DEV_LOGIN=true
DEBUG=true

# Backend Service Configuration
HOST=0.0.0.0

# Enhanced Timeout Configuration for Infrastructure Resilience
# Connection Timeouts - Aggressive for Connectivity Detection
INFRASTRUCTURE_HEALTH_CHECK_TIMEOUT=5
STAGING_CONNECTION_TIMEOUT=10
FALLBACK_ACTIVATION_TIMEOUT=3

# WebSocket Configuration - Optimized for Intermittent Connectivity
WEBSOCKET_CONNECTION_TIMEOUT=30
WEBSOCKET_RECV_TIMEOUT=20
WEBSOCKET_SEND_TIMEOUT=15
WEBSOCKET_HEARTBEAT_INTERVAL=15
WEBSOCKET_HEARTBEAT_TIMEOUT=45
WEBSOCKET_RECONNECT_ATTEMPTS=3
WEBSOCKET_RECONNECT_DELAY=5

# Agent Configuration - Shortened for Resilience
AGENT_EXECUTION_TIMEOUT=20
AGENT_THINKING_TIMEOUT=15
AGENT_TOOL_TIMEOUT=10
AGENT_COMPLETION_TIMEOUT=10

# Test Framework Resilience Settings
TEST_RETRY_ATTEMPTS=3
TEST_RETRY_DELAY=2
TEST_SKIP_ON_INFRASTRUCTURE_FAILURE=true
TEST_GRACEFUL_DEGRADATION=true
TEST_CONNECTIVITY_VALIDATION=true

# Database Connection Pool Settings - Resilient
DATABASE_CONNECTION_TIMEOUT=5
DATABASE_QUERY_TIMEOUT=10
DATABASE_POOL_SIZE=2
DATABASE_MAX_OVERFLOW=1

# Monitoring and Alerts
INFRASTRUCTURE_MONITORING_ENABLED=true
CONNECTIVITY_ALERTS_ENABLED=true
FALLBACK_LOGGING_ENABLED=true

# Issue #1278 Specific Settings
ISSUE_1278_WORKAROUND_ENABLED=true
VPC_CONNECTOR_BYPASS_MODE=true
CLOUD_SQL_FALLBACK_MODE=true