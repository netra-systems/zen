# Staging Environment Configuration
# This file defines environment variables for staging deployments

# Environment Setting
ENVIRONMENT=staging

# Database Configuration
# Cloud SQL connection via Unix socket - DO NOT use localhost

# Redis Configuration  
# Staging uses a shared Redis instance with database separation by PR

# ClickHouse Configuration
CLICKHOUSE_URL=clickhouse://default:@xedvrr4c3r.us-central1.gcp.clickhouse.cloud:8443/default?secure=1
CLICKHOUSE_HOST=xedvrr4c3r.us-central1.gcp.clickhouse.cloud
CLICKHOUSE_PORT=8443
CLICKHOUSE_USERNAME=default
CLICKHOUSE_USER=default
# CLICKHOUSE_PASSWORD is loaded from GCP Secret Manager
# Secret name: clickhouse-password-staging
# DO NOT SET HERE - Will be injected by Cloud Run via --set-secrets
CLICKHOUSE_PASSWORD=
CLICKHOUSE_DB=default
CLICKHOUSE_SECURE=true
CLICKHOUSE_TIMEOUT=30
CLICKHOUSE_REQUIRED=true

# Redis Configuration
REDIS_REQUIRED=true
REDIS_FALLBACK_ENABLED=true

# Service Configuration
SERVER_PORT=8080
LOG_LEVEL=INFO

# Authentication Configuration (staging defaults)
# These will be overridden by secrets in actual deployment
# CRITICAL: These are proper 32+ character secrets for staging deployment
SECRET_KEY=MNirOcTwpRfPUhpMHB7n6VOTCD3ggxgWlC8n3ZyZIuE
JWT_SECRET_STAGING=7SVLKvh7mJNeF6njiRJMoZpUWLya3NfsvJfRHPc0-cYI7Oh80oXOUHuBNuMjUI4ghNTHFH0H7s9vf3S835ET5A
SERVICE_SECRET=staging-service-secret-distinct-from-jwt-7SVLKvh7mJNeF6njiRJMoZpUWLya3NfsvJfRHPc0-staging-distinct
FERNET_KEY=pbQTBDr9qfDGaNTc9GjtJOAvx9q5zPKAtpf45e1xcJo=

# JWT Configuration - Consistent across all services
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
# New standardized JWT variables (preferred)
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_SERVICE_TOKEN_EXPIRE_MINUTES=60
# Old deprecated variables (kept for backward compatibility)
JWT_ACCESS_EXPIRY_MINUTES=15
JWT_REFRESH_EXPIRY_DAYS=7
JWT_SERVICE_EXPIRY_MINUTES=60

# Feature Flags for Staging
SKIP_MIGRATION_ON_STARTUP=false
ENABLE_STARTUP_CHECKS=true
STARTUP_CHECK_TIMEOUT=30

# API Configuration for Staging
API_BASE_URL=https://api.staging.netrasystems.ai
WS_BASE_URL=wss://api.staging.netrasystems.ai/ws
FRONTEND_URL=https://app.staging.netrasystems.ai
MCP_BASE_URL=https://api.staging.netrasystems.ai

# CORS Configuration
CORS_ALLOWED_ORIGINS=https://app.staging.netrasystems.ai,https://api.staging.netrasystems.ai

# Health Check Configuration
HEALTH_CHECK_GRACE_PERIOD=60
HEALTH_CHECK_MAX_RETRIES=5

# Google OAuth Configuration (staging)
# These will be set from GCP Secret Manager in deployment
GOOGLE_CLIENT_ID=REPLACE_WITH_GOOGLE_CLIENT_ID_FOR_STAGING
GOOGLE_CLIENT_SECRET=REPLACE_WITH_GOOGLE_CLIENT_SECRET_FOR_STAGING
GOOGLE_OAUTH_CLIENT_ID_STAGING=REPLACE_WITH_GOOGLE_CLIENT_ID_FOR_STAGING
GOOGLE_OAUTH_CLIENT_SECRET_STAGING=REPLACE_WITH_GOOGLE_CLIENT_SECRET_FOR_STAGING

# OAuth Configuration
# CRITICAL: These are DEPRECATED - OAuth redirect URI is managed by GoogleOAuthProvider.get_redirect_uri()
# See: /auth_service/auth_core/oauth/google_oauth.py:78 for SSOT implementation
# See: /OAUTH_SSOT_COMPLIANCE_ANALYSIS.md for why these were causing failures
# DO NOT USE THESE - They violate SSOT principles
# OAUTH_REDIRECT_URI=DEPRECATED_DO_NOT_USE
# OAUTH_CALLBACK_URL=DEPRECATED_DO_NOT_USE

# E2E Test Configuration
# CRITICAL: This key enables WebSocket authentication bypassing for staging E2E tests
# Required for staging test suite to validate WebSocket agent events
# Set to bypass key that matches auth service E2E OAuth simulation
E2E_OAUTH_SIMULATION_KEY=staging-e2e-test-bypass-key-2025