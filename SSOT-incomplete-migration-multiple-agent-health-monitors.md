# SSOT-incomplete-migration-multiple-agent-health-monitors

**GitHub Issue:** #211 - https://github.com/netra-systems/netra-apex/issues/211  
**Status:** Discovery Phase  
**Priority:** Critical - Blocking Golden Path

## Problem Summary

Multiple AgentHealthMonitor implementations violate SSOT principles and block golden path chat functionality. Users experiencing inconsistent AI response delivery due to fragmented health monitoring.

## Critical SSOT Violations Identified

### Violation #1: Multiple Health Monitoring Implementations (CRITICAL)
- **Files:**
  - `/netra_backend/app/core/agent_health_monitor.py` (283 lines - Core SSOT candidate)
  - `/dev_launcher/health_monitor.py` (700 lines - Development infrastructure)
  - `/dev_launcher/enhanced_health_monitor.py` (686 lines - Enhanced version)
- **Impact:** Inconsistent agent death detection, fragmented monitoring logic
- **Golden Path Impact:** Silent agent failures, inconsistent WebSocket events

### Violation #2: Scattered Agent Status Tracking (HIGH)
- **Files:**
  - `/netra_backend/app/agents/supervisor/agent_registry.py` (AgentLifecycleManager)
  - `/netra_backend/app/core/agent_execution_tracker.py` (ExecutionRecord)
  - `/netra_backend/app/core/agent_health_monitor.py` (Health status)
- **Impact:** Race conditions, no single source for "is agent alive?"

### Violation #3: WebSocket Health Monitoring Fragmentation (HIGH)
- **Impact:** Users experience WebSocket disconnects without agent health recovery

## Remediation Strategy

### Phase 1: SSOT Core Health Monitor (PRIORITY 1)
- Designate `/netra_backend/app/core/agent_health_monitor.py` as SSOT
- Consolidate logic from dev_launcher modules
- Standardize death detection thresholds

### Phase 2: Unified Agent State Tracking (PRIORITY 2)  
- Centralize health state in AgentHealthMonitor
- Refactor AgentRegistry delegation
- Eliminate duplicate tracking

### Phase 3: WebSocket-Agent Health Integration (PRIORITY 3)
- Create unified chat experience health assessment
- Integrate WebSocket + agent health status

## Progress Tracking

- [x] Step 0: SSOT Audit Complete
- [x] GitHub Issue Created (#211)
- [x] IND File Created
- [ ] Step 1: Test Discovery and Planning
- [ ] Step 2: Execute Test Plan  
- [ ] Step 3: Plan SSOT Remediation
- [ ] Step 4: Execute Remediation
- [ ] Step 5: Test Fix Loop
- [ ] Step 6: PR and Closure

## Next Actions

1. Discover existing tests protecting health monitoring functionality
2. Plan test suite for SSOT AgentHealthMonitor
3. Create failing tests that reproduce SSOT violations
4. Execute remediation plan

## Business Value Justification

- **Segment:** Platform (affects all user tiers)
- **Business Goal:** Stability - ensure reliable AI response delivery  
- **Value Impact:** Consistent agent health monitoring enables 90% of chat functionality value
- **Revenue Impact:** Prevents user churn from unreliable chat experience

---
*Generated by SSOT Gardener - Agent Health Monitor Focus*