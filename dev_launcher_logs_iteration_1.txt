===============================================================
DEV LAUNCHER LOGS - ITERATION 1
Date: 2025-08-26
Start Time: 13:56:17 UTC
===============================================================

SUMMARY:
- Services successfully started: Backend (8000), Auth (8081), Database (PostgreSQL, Redis, ClickHouse)
- Issues encountered: Circuit breaker issues with auth service communication, WebSocket authentication failures
- Frontend startup: Attempted but failed with Turbopack configuration
- Overall system: Partially functional with core backend services running

===============================================================
FULL OUTPUT:
===============================================================

STDERR OUTPUT:
Created unified circuit breaker: database_retry_circuit
Created unified circuit breaker: llm_retry_circuit
Created unified circuit breaker: api_retry_circuit
Created unified circuit breaker: auth_service_retry_circuit
Created unified circuit breaker: netra_backend_retry_circuit
Created unified circuit breaker: dev_launcher_retry_circuit
Populated secrets for development
ServiceDiscoverySystem initialized with discovery file: .dev_services_discovery.json
No existing discovery file found
Using smart default service configuration with availability detection
Service adjustment: âœ… Started Redis Docker container
Service adjustment: âœ… Started ClickHouse Docker container
Service adjustment: REDIS service using local mode: Local Redis not installed, but Docker available - will start Redis container
Service adjustment: CLICKHOUSE service using local mode: Local ClickHouse not installed, but Docker available - will start ClickHouse container
HealthMonitor initialized (check_interval: 30s)
Windows process verification enabled
ProcessManager initialized for win32
Enhanced Windows process tree management enabled
Race condition manager initialized
Windows console event handlers registered
Signal handler initialized for win32
Discovered 3 database connections
Discovered 2 WebSocket endpoints
Environment isolation enabled
ReadinessManager initialized
DependencyManager initialized
Added service database with 0 dependencies
Added service redis with 0 dependencies
Added service auth with 2 dependencies
Added service backend with 3 dependencies
Added service frontend with 1 dependencies
Added service websocket with 2 dependencies
Computed startup order: database â†’ redis â†’ auth â†’ backend â†’ frontend â†’ websocket
[... additional dependency manager initialization ...]
ServiceCoordinator initialized with config: required={'database', 'backend'}, optional={'auth', 'redis', 'frontend'}
[... service registration and readiness checker setup ...]
Comprehensive signal handlers registered for graceful shutdown

USING DIRECT UVICORN LAUNCH
Backend hot reload: DISABLED
RuntimeWarning: line buffering (buffering=1) isn't supported in binary mode, the default buffer size will be used

STDOUT OUTPUT:
ğŸ” DISCOVER | POSTGRESQL: postgresql+asyncpg://postgres:***@localhost:5433/netra_dev
ğŸ” DISCOVER | CLICKHOUSE: http://default:***@localhost:8123/netra_dev
ğŸ” DISCOVER | REDIS: redis://localhost:6379/0
[DISCOVER] WEBSOCKET | Discovered endpoint: main_ws -> ws://localhost:8000/ws (required)
[DISCOVER] WEBSOCKET | Discovered endpoint: mcp_ws -> ws://localhost:8000/api/mcp/ws (optional)

ğŸš€ Starting Netra AI Development Environment...
   â†’ Windows environment detected
   â†’ Enhanced process tree management enabled
   â†’ Port cleanup verification enabled

============================================================
ğŸš€ Netra AI Development Environment
============================================================
Services Configuration:
   Redis: local
   ClickHouse: local
   PostgreSQL: docker
   LLM: shared
============================================================

ğŸ“ Configuration:
ğŸ”§ Service Modes:
  ğŸ’» Redis       : Local  (localhost:6379)
  ğŸ’» ClickHouse  : Local  (localhost:9000)
  ğŸ§ª PostgreSQL  : Docker
  â˜ï¸ LLM         : On    

  â€¢ Dynamic ports: NO
  â€¢ Backend hot reload: NO
  â€¢ Frontend hot reload: YES (Next.js native)
  â€¢ Real-time logging: YES
  â€¢ Turbopack: YES
  â€¢ Secret loading: NO
  â€¢ Verbose output: NO

ğŸ”„ Running pre-checks in parallel...
ğŸ”’ Local secrets loaded (GCP disabled)
ğŸ” Checking environment...
âœ… Environment check passed
â„¹ï¸ Set BACKEND_PORT=8000
â„¹ï¸ Set FRONTEND_PORT=3000
â„¹ï¸ Set AUTH_PORT=8081
â„¹ï¸ Set WEBSOCKET_PORT=8000
â„¹ï¸ Set LOG_LEVEL=INFO
â„¹ï¸ Set CORS_ORIGINS=*
ğŸ”‘ Using existing cross-service auth token (86 chars)
ğŸ” Found running Docker services: postgres, clickhouse, redis
âœ… Postgres: netra-postgres-dev (Up 23 hours (healthy))
âœ… Clickhouse: netra-clickhouse-dev (Up 23 hours (healthy))
âœ… Redis: netra-redis-dev (Up 23 hours (healthy))

ğŸ”„ Analyzing service availability...
 REDIS: local â†’ local (Local Redis not installed, but Docker available - will start Redis container (Docker mode))
 CLICKHOUSE: local â†’ local (Local ClickHouse not installed, but Docker available - will start ClickHouse container (Docker mode))
ğŸ”§ Applied service availability recommendations
ğŸ”„ Updated 29 environment variables
âœ… Successfully configured 3 service(s)
âœ… Environment and services ready
âš¡ Parallel execution saved 90.6% time (49.0s â†’ 4.6s)
âœ… Completed 3/3 pre-checks in 4.6s
âœ… Found 3 reusable Docker service(s)
ğŸ”„ Will reuse postgres: netra-postgres-dev (Up 23 hours (healthy))
ğŸ”„ Will reuse clickhouse: netra-clickhouse-dev (Up 23 hours (healthy))
ğŸ”„ Will reuse redis: netra-redis-dev (Up 23 hours (healthy))
âœ… Pre-checks completed (cache, environment, secrets)

ğŸ”„ Validating database connections with network resilience...
âœ… Postgres connection validated
âœ… Redis connection validated
âš ï¸ Clickhouse connection failed: Database connection failed after 5 attempts
âœ… Connected to 2 database service(s)
âš ï¸ 1 database service(s) failed - using fallback validation

ğŸ”§ Initializing databases for cold start...
â„¹ï¸ Connecting to: postgresql://netra_dev:***@127.0.0.1:5433/netra_dev
âš ï¸ Connection attempt 1 failed, will retry
ğŸ”„ Retrying PostgreSQL initialization (attempt 2/3) in 2.6s
âš ï¸ Connection attempt 2 failed, will retry
ğŸ”„ Retrying PostgreSQL initialization (attempt 3/3) in 4.4s
âŒ Cannot connect to PostgreSQL after all retries
âš ï¸ PostgreSQL initialization had issues, continuing...
âœ… Database initialization completed

ğŸ” Validating connections for: Redis, ClickHouse, PostgreSQL
ğŸ”„ DATABASE | Validating 3 database connections...
ğŸ”„ CONNECT | main_postgres: Attempt 1/5
ğŸ”„ CONNECT | main_clickhouse: Attempt 1/5
ğŸ”„ CONNECT | main_redis: Attempt 1/5
âœ… CONNECT | main_redis: Connected successfully
âœ… CONNECT | main_clickhouse: Connected successfully
âœ… CONNECT | main_postgres: Connected successfully
âœ… DATABASE | All database connections validated successfully
âœ… Database connections validated and ready: redis

ğŸ”„ Checking and running migrations...
âœ… Database schema is up-to-date

ğŸ”„ Starting backend and auth services...
ğŸš€ Starting backend server (Redis:local, ClickHouse:local, PostgreSQL:docker, LLM:cloud)...
â³ Waiting for backend initialization on port 8000...

[BACKEND] STARTUP SEQUENCE:
âœ… Circuit breakers created (database, llm, api, auth_service, netra_backend, dev_launcher)
âœ… Environment configuration loaded
âœ… Background task manager initialized 
âœ… CORS middleware configured for development environment
âœ… WebSocket CORS configured with 34 allowed origins
âœ… Authentication middleware configured
âœ… Session middleware configured
âœ… Unified tool registry initialized
âœ… Synthetic data service initialized
âœ… Quality gate and monitoring services initialized
âœ… Server process started [56500]
âœ… Application startup initiated

STARTUP COMPONENTS INITIALIZATION:
âœ… Database initialization (4.21s) - All 26 database tables present
âœ… Auth service initialization (0.00s)
âœ… Redis initialization (0.06s) - Connected successfully
âœ… WebSocket initialization (0.00s)
âœ… Agent supervisor initialization (0.05s) - 7 agents registered (triage, data, optimization, actions, reporting, synthetic_data, corpus_admin)
âœ… Background tasks initialization (0.00s) - 4/5 startup fixes applied
âœ… ClickHouse initialization (2.43s) - Tables initialized
âœ… Monitoring initialization (0.00s)
âœ… Metrics initialization (0.00s)
âœ… Tracing initialization (0.00s)

âœ… System Ready (Took 6.94s) - 10/10 successful, 0 degraded, 0 failed
âœ… Uvicorn running on http://0.0.0.0:8000

âœ… Backend started on port 8000
âœ… Backend service started successfully

ğŸ” Starting auth service (using local Redis (localhost:6379))...
[AUTH] STARTUP SEQUENCE:
âœ… Circuit breakers created
âœ… Environment configuration loaded
âœ… JWT validation cache initialized - Redis enabled
âœ… JWT secret configured (shared with backend)
âœ… Redis connected for session management
âš ï¸ Using generated HMAC secret - set OAUTH_HMAC_SECRET for production
âœ… Signal handlers configured for graceful shutdown

âœ… Auth service started on port 8081
âœ… Auth service started successfully

ğŸ”„ Waiting for backend readiness...
âœ… Backend API URL: http://localhost:8000
âœ… Backend WebSocket URL: ws://localhost:8000/ws
âœ… Service ready at http://localhost:8000/health/ after 1 attempts

ONGOING ACTIVITY:
- Health checks running on both services (backend /health/ready returning 200)
- Auth service handling config requests and dev logins successfully
- ClickHouse connections establishing and working
- API requests being processed (some with 307 redirects, some with 401 auth failures)

ISSUES ENCOUNTERED:
âŒ Circuit breaker for auth_service went OPEN due to connection failures
âŒ WebSocket authentication failing due to auth service circuit breaker
âŒ Some ClickHouse query failures (error code 0)
âŒ Token validation failing due to circuit breaker state
âŒ Frontend startup failed with Turbopack configuration issues

FINAL STEPS ATTEMPTED:
âŒ Backend readiness check failed
âŒ Auth verification failed  
âŒ Frontend start failed

===============================================================
KEY OBSERVATIONS:
===============================================================

1. **SUCCESSFUL COMPONENTS:**
   - Docker services (PostgreSQL, Redis, ClickHouse) all running and healthy
   - Backend service fully initialized and responding on port 8000
   - Auth service running on port 8081
   - Database schema up-to-date with all 26 tables
   - Agent supervisor with 7 registered agents
   - Health endpoints responding (status 200)

2. **CRITICAL ISSUES:**
   - Auth service circuit breaker in OPEN state causing authentication failures
   - WebSocket connections failing due to JWT validation issues
   - Communication breakdown between backend and auth services
   - Frontend failed to start due to Turbopack configuration issues

3. **INFRASTRUCTURE STATUS:**
   - All Docker containers healthy and running for 23+ hours
   - Database connections working (PostgreSQL, Redis, ClickHouse)
   - Environment variables properly configured
   - Ports correctly assigned (Backend: 8000, Auth: 8081, Frontend: 3000)

4. **SYSTEM HEALTH:**
   - Core backend functionality appears operational
   - Database operations working
   - API endpoints accessible (though some require authentication)
   - Monitoring and logging systems active
   - Circuit breakers and resilience patterns in place

===============================================================
RECOMMENDATIONS:
===============================================================

1. **IMMEDIATE FIXES NEEDED:**
   - Investigate auth service communication failures
   - Reset circuit breaker state for auth_service
   - Fix Turbopack configuration for frontend
   - Resolve WebSocket authentication pipeline

2. **MONITORING:**
   - System is partially functional for backend API testing
   - Database operations can be performed
   - Health endpoints are responding correctly

3. **NEXT STEPS:**
   - Debug inter-service communication issues
   - Test individual service endpoints
   - Verify authentication token generation and validation
   - Restart services to clear circuit breaker states

===============================================================
END OF LOG FILE
===============================================================