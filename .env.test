# Environment Configuration for Unified Testing
# This file contains all environment variables needed for containerized testing
# Used by docker-compose.test.yml to ensure consistent test environment

# =============================================================================
# GENERAL CONFIGURATION
# =============================================================================
ENVIRONMENT=test
NODE_ENV=test
PYTHONUNBUFFERED=1
LOG_LEVEL=INFO

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL - Main Database
DATABASE_URL=postgresql://test_user:test_password@test-postgres:5432/netra_test
POSTGRES_DB=netra_test
POSTGRES_USER=test_user
POSTGRES_PASSWORD=test_password
POSTGRES_HOST=test-postgres
POSTGRES_PORT=5432

# PostgreSQL - Auth Database  
AUTH_DATABASE_URL=postgresql://test_user:test_password@test-postgres:5432/netra_auth_test
AUTH_POSTGRES_DB=netra_auth_test

# ClickHouse - Analytics Database
CLICKHOUSE_URL=http://test_user:test_password@test-clickhouse:8123/netra_analytics_test
CLICKHOUSE_HOST=test-clickhouse
CLICKHOUSE_PORT=8123
CLICKHOUSE_USER=test_user
CLICKHOUSE_PASSWORD=test_password
CLICKHOUSE_DATABASE=netra_analytics_test

# Redis - Caching and Sessions
REDIS_URL=redis://:test_password@test-redis:6379/0
REDIS_HOST=test-redis
REDIS_PORT=6379
REDIS_PASSWORD=test_password

# =============================================================================
# SERVICE URLS (Container Network)
# =============================================================================
AUTH_SERVICE_URL=http://auth-service:8080
BACKEND_SERVICE_URL=http://backend-service:8000
FRONTEND_SERVICE_URL=http://frontend-service:3000

# External URLs (Host Network - for browser/external access)
AUTH_SERVICE_URL_EXTERNAL=http://localhost:8001
BACKEND_SERVICE_URL_EXTERNAL=http://localhost:8000
FRONTEND_SERVICE_URL_EXTERNAL=http://localhost:3000

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
SECRET_KEY=test_auth_secret_key_unified_testing_do_not_use_in_production
JWT_SECRET_KEY=test_auth_secret_key_unified_testing_do_not_use_in_production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# OAuth Configuration (Test Values - Do Not Use in Production)
GOOGLE_CLIENT_ID=test_google_client_id_for_unified_testing
GOOGLE_CLIENT_SECRET=test_google_client_secret_for_unified_testing
GOOGLE_REDIRECT_URI=http://localhost:8001/auth/google/callback

GITHUB_CLIENT_ID=test_github_client_id_for_unified_testing
GITHUB_CLIENT_SECRET=test_github_client_secret_for_unified_testing
GITHUB_REDIRECT_URI=http://localhost:8001/auth/github/callback

# =============================================================================
# LLM & AI CONFIGURATION (Test Mode)
# =============================================================================
# These are test/mock values - do not use real API keys in testing
OPENAI_API_KEY=test_openai_key_do_not_use_real_api_in_tests
ANTHROPIC_API_KEY=test_anthropic_key_do_not_use_real_api_in_tests
USE_MOCK_LLM=true
ENABLE_REAL_LLM_TESTS=false

# LangSmith (Disabled for testing)
LANGCHAIN_TRACING_V2=false
LANGCHAIN_ENDPOINT=""
LANGCHAIN_API_KEY=""
LANGCHAIN_PROJECT=""

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================
WEBSOCKET_ENABLE=true
WEBSOCKET_PING_INTERVAL=30
WEBSOCKET_PING_TIMEOUT=10
WEBSOCKET_MAX_CONNECTIONS=100

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
FRONTEND_URL=http://frontend-service:3000
CORS_ORIGINS=["http://localhost:3000", "http://frontend-service:3000", "http://localhost:8000", "http://backend-service:8000"]

# =============================================================================
# FEATURE FLAGS (Testing)
# =============================================================================
ENABLE_DEBUG_MODE=true
ENABLE_TEST_ROUTES=true
ENABLE_MOCK_DATA=true
DISABLE_RATE_LIMITING=true
DISABLE_EMAIL_SENDING=true
DISABLE_ANALYTICS_TRACKING=true

# =============================================================================
# TEST USER CONFIGURATION
# =============================================================================
# Pre-created test users for consistent testing
TEST_USER_EMAIL=test@netra.ai
TEST_USER_PASSWORD=test_password_123
TEST_USER_ID=test-user-12345

TEST_ADMIN_EMAIL=admin@netra.ai
TEST_ADMIN_PASSWORD=admin_password_123
TEST_ADMIN_ID=test-admin-67890

# =============================================================================
# TESTING FRAMEWORK CONFIGURATION
# =============================================================================
# Pytest Configuration
PYTEST_TIMEOUT=300
PYTEST_MAXFAIL=5
PYTEST_WORKERS=auto

# Test Data Configuration
TEST_DATA_SEED=12345
TEST_DATA_SIZE=small
CLEANUP_TEST_DATA=true

# Test Reporting
GENERATE_TEST_REPORTS=true
TEST_REPORT_FORMAT=json,html
TEST_RESULTS_DIR=/app/test_results

# =============================================================================
# PERFORMANCE & MONITORING (Test Mode)
# =============================================================================
# Disable production monitoring in tests
DISABLE_PROMETHEUS=true
DISABLE_SENTRY=true
DISABLE_DATADOG=true

# Test Performance Thresholds
MAX_RESPONSE_TIME_MS=5000
MAX_DB_QUERY_TIME_MS=1000
MAX_WEBSOCKET_LATENCY_MS=500

# =============================================================================
# STORAGE CONFIGURATION (Test)
# =============================================================================
# Use local/temporary storage for tests
UPLOAD_DIR=/app/uploads
MAX_FILE_SIZE_MB=10
ALLOWED_FILE_TYPES=["json", "csv", "txt", "pdf"]

# Cloud Storage (Disabled for testing)
USE_CLOUD_STORAGE=false
GCS_BUCKET_NAME=""
AWS_S3_BUCKET=""

# =============================================================================
# EMAIL CONFIGURATION (Test/Mock)
# =============================================================================
# Email sending disabled in test environment
EMAIL_BACKEND=mock
SMTP_HOST=""
SMTP_PORT=587
SMTP_USER=""
SMTP_PASSWORD=""
FROM_EMAIL=test@netra.ai

# =============================================================================
# INTEGRATION TEST CONFIGURATION
# =============================================================================
# Timeouts for integration tests
SERVICE_STARTUP_TIMEOUT=60
HEALTH_CHECK_TIMEOUT=30
WEBSOCKET_CONNECTION_TIMEOUT=10

# Test Scenarios
RUN_SMOKE_TESTS=true
RUN_INTEGRATION_TESTS=true
RUN_E2E_TESTS=true
RUN_PERFORMANCE_TESTS=false

# Test User Journey Configuration
CREATE_TEST_CONVERSATIONS=true
TEST_CONVERSATION_COUNT=5
TEST_MESSAGE_COUNT_PER_CONVERSATION=10

# =============================================================================
# DOCKER COMPOSE SPECIFIC
# =============================================================================
# Container Configuration
COMPOSE_PROJECT_NAME=netra-unified-test
COMPOSE_HTTP_TIMEOUT=120
DOCKER_BUILDKIT=1

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=40s