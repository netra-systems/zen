# Elite Enforcement Pre-commit Configuration for Netra Apex
# MANDATORY: 450-line file limit, 25-line function limit
repos:
  - repo: local
    hooks:
      # CRITICAL: Architecture Compliance Check (blocks commits on violations)
      - id: architecture-compliance
        name: Architecture Compliance Enforcer
        entry: python scripts/enforce_limits.py --mode strict --fail-fast
        language: system
        files: '^(app|frontend|scripts|tests).*\.(py|ts|tsx)$'
        stages: [commit]
        description: 'Enforces 450-line file and 25-line function limits'
        
      # File Size Enforcement (450-line limit)
      - id: file-size-limit
        name: File Size Limit (300 lines)
        entry: python scripts/enforce_limits.py --check-files-only --max-lines 300
        language: system
        files: '\.(py|ts|tsx)$'
        stages: [commit]
        pass_filenames: true
        
      # Function Complexity Enforcement (25-line limit)  
      - id: function-complexity-limit
        name: Function Complexity Limit (8 lines)
        entry: python scripts/enforce_limits.py --check-functions-only --max-function-lines 8
        language: system
        files: '\.py$'
        stages: [commit]
        pass_filenames: true
        
      # Type Safety and Duplicate Prevention
      - id: type-safety-check
        name: Type Safety and Duplicate Prevention
        entry: python scripts/enforce_limits.py --check-types --prevent-duplicates
        language: system
        files: '\.(py|ts|tsx)$'
        stages: [commit]
        
      # Test Stub Detection (prevents production stubs)
      - id: test-stub-prevention
        name: Test Stub Prevention
        entry: python scripts/enforce_limits.py --check-stubs --fail-on-stubs
        language: system
        files: '\.py$'
        stages: [commit]
        
      # TEST FILES: Enforce same limits as production code (SPEC/testing.xml)
      - id: test-file-size-enforcement
        name: Test File Size Enforcement (300 lines)
        entry: python scripts/compliance/test_size_validator.py --strict --format json
        language: system
        files: '(test_.*\.py|.*_test\.py|tests/.*\.py)$'
        stages: [commit]
        description: 'Test files MUST follow same 450-line limit as production code (SPEC/testing.xml)'
