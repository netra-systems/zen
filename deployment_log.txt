
🚀 Using Alpine-optimized images (default):
   • 78% smaller images (150MB vs 350MB)
   • 3x faster startup times
   • 68% cost reduction ($205/month vs $650/month)
   • Optimized resource limits (512MB RAM vs 2GB)

  Container runtime: Docker
🚀 Deploying Netra Apex Platform to GCP
   Project: netra-staging
   Region: us-central1
   Build Mode: Local (Fast)
   Pre-checks: Disabled
   Config Validation: Enabled (default)

✅ Phase 0: Validating Deployment Configuration...
   Checking against proven working configuration from netra-backend-staging-00035-fnj
Exception in thread Thread-9 (_readerthread):
Traceback (most recent call last):
  File "C:\Users\antho\miniconda3\Lib\threading.py", line 1073, in _bootstrap_inner
    self.run()
  File "C:\Users\antho\miniconda3\Lib\threading.py", line 1010, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\antho\miniconda3\Lib\subprocess.py", line 1599, in _readerthread
    buffer.append(fh.read())
                  ^^^^^^^^^
  File "C:\Users\antho\miniconda3\Lib\encodings\cp1252.py", line 23, in decode
    return codecs.charmap_decode(input,self.errors,decoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeDecodeError: 'charmap' codec can't decode byte 0x8d in position 309: character maps to <undefined>
   ✅ Configuration matches proven working setup

🔐 Phase 1: Validating Prerequisites...
✅ gcloud CLI configured for project: netra-staging

🔧 Enabling required GCP APIs...
  Enabling run.googleapis.com...
  Enabling containerregistry.googleapis.com...
  Enabling cloudbuild.googleapis.com...
  Enabling secretmanager.googleapis.com...
  Enabling compute.googleapis.com...
✅ All required APIs enabled

🔐 Phase 2: Validating Secrets Configuration...
Checking all required secrets in Secret Manager...
  ✅ Secret configured: clickhouse-password-staging
  ✅ Secret configured: postgres-db-staging
  ✅ Secret configured: secret-key-staging
  ✅ Secret configured: oauth-hmac-secret-staging
  ✅ Secret configured: postgres-password-staging
  ✅ Secret configured: redis-password-staging
  ✅ Secret configured: openai-api-key-staging
  ✅ Secret configured: redis-url-staging
  ✅ Secret configured: google-oauth-client-id-staging
  ✅ Secret configured: service-id-staging
  ✅ Secret configured: google-oauth-client-secret-staging
  ✅ Secret configured: jwt-secret-key-staging
  ✅ Secret configured: postgres-user-staging
  ✅ Secret configured: gemini-api-key-staging
  ✅ Secret configured: fernet-key-staging
  ✅ Secret configured: postgres-host-staging
  ✅ Secret configured: service-secret-staging
  ✅ Secret configured: postgres-port-staging
  ✅ Secret configured: jwt-secret-staging

✅ All required secrets are configured
   Service Filter: backend

🏗️ Phase 4: Building and Deploying Services...
   All prerequisites validated - proceeding with deployment

   Building backend...

🔨 Building backend Docker image locally...
  Using existing docker/backend.staging.alpine.Dockerfile
  Building image locally: gcr.io/netra-staging/netra-backend-staging:latest
  This is 5-10x faster than Cloud Build...
ERROR: error during connect: Head "http://%2F%2F.%2Fpipe%2FdockerDesktopLinuxEngine/_ping": open //./pipe/dockerDesktopLinuxEngine: The system cannot find the file specified.
❌ Failed to build backend locally: Command '['docker', 'build', '-t', 'gcr.io/netra-staging/netra-backend-staging:latest', '-f', 'docker/backend.staging.alpine.Dockerfile', '--platform', 'linux/amd64', '.']' returned non-zero exit status 1.
   Tip: Ensure Docker Desktop is running
❌ Failed to build backend
