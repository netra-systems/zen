{
  "metadata": {
    "description": "Boundary conditions and error scenarios for robust testing",
    "version": "1.0",
    "created": "2025-01-20T00:00:00Z",
    "record_count": {
      "malformed_requests": 15,
      "rate_limited_scenarios": 8,
      "timeout_scenarios": 12,
      "high_memory_patterns": 10
    }
  },
  "malformed_requests": [
    {
      "id": "malformed_1",
      "name": "Missing required fields",
      "description": "Request missing essential parameters",
      "request_data": {
        "user_id": null,
        "message": "",
        "model_preference": "invalid_model"
      },
      "expected_error": "validation_error",
      "error_code": "MISSING_REQUIRED_FIELDS",
      "should_retry": false,
      "fallback_behavior": "request_clarification"
    },
    {
      "id": "malformed_2",
      "name": "Invalid JSON structure",
      "description": "Malformed JSON payload",
      "request_data": "{'incomplete': 'json', 'missing_quote: 'value'}",
      "expected_error": "parse_error",
      "error_code": "INVALID_JSON_FORMAT",
      "should_retry": false,
      "fallback_behavior": "return_format_error"
    },
    {
      "id": "malformed_3",
      "name": "Extremely long message",
      "description": "Message exceeding maximum token limits",
      "request_data": {
        "user_id": "test_user_1",
        "message": "A" * 50000,
        "model_preference": "gpt-4"
      },
      "expected_error": "content_too_long_error",
      "error_code": "MESSAGE_TOO_LONG",
      "should_retry": false,
      "fallback_behavior": "truncate_and_warn"
    },
    {
      "id": "malformed_4",
      "name": "Invalid Unicode characters",
      "description": "Message containing invalid or dangerous Unicode",
      "request_data": {
        "user_id": "test_user_1",
        "message": "Test message with \u0000 null bytes and \uFFFE invalid chars",
        "model_preference": "claude-3-sonnet"
      },
      "expected_error": "encoding_error",
      "error_code": "INVALID_UNICODE",
      "should_retry": false,
      "fallback_behavior": "sanitize_content"
    },
    {
      "id": "malformed_5",
      "name": "SQL injection attempt",
      "description": "Message attempting SQL injection",
      "request_data": {
        "user_id": "test_user_1",
        "message": "'; DROP TABLE users; SELECT * FROM sensitive_data; --",
        "model_preference": "gpt-3.5-turbo"
      },
      "expected_error": "security_violation",
      "error_code": "POTENTIAL_INJECTION_ATTACK",
      "should_retry": false,
      "fallback_behavior": "block_and_log"
    }
  ],
  "rate_limited_scenarios": [
    {
      "id": "rate_limit_1",
      "name": "Burst request scenario",
      "description": "Sudden spike in requests exceeding provider limits",
      "scenario_config": {
        "requests_per_second": 100,
        "duration_seconds": 10,
        "provider": "openai",
        "model": "gpt-4",
        "expected_rate_limit": "requests_per_minute"
      },
      "expected_behavior": {
        "throttling_activated": true,
        "queue_requests": true,
        "fallback_to_alternative": true,
        "user_notification": "rate_limit_warning"
      },
      "success_criteria": {
        "request_loss_rate": 0.05,
        "average_delay_increase": 2000,
        "user_experience_degradation": "minimal"
      }
    },
    {
      "id": "rate_limit_2",
      "name": "Sustained high load",
      "description": "Continuous high request volume over extended period",
      "scenario_config": {
        "requests_per_second": 50,
        "duration_seconds": 300,
        "provider": "anthropic",
        "model": "claude-3-opus",
        "expected_rate_limit": "tokens_per_minute"
      },
      "expected_behavior": {
        "intelligent_queuing": true,
        "load_balancing": true,
        "circuit_breaker_activation": true,
        "cost_optimization": true
      },
      "success_criteria": {
        "throughput_maintenance": 0.85,
        "cost_efficiency": 0.90,
        "system_stability": "maintained"
      }
    },
    {
      "id": "rate_limit_3",
      "name": "Cross-provider rate limiting",
      "description": "Rate limits affecting multiple providers simultaneously",
      "scenario_config": {
        "affected_providers": ["openai", "anthropic", "google"],
        "limit_severity": "severe",
        "duration_seconds": 180,
        "concurrent_users": 50
      },
      "expected_behavior": {
        "emergency_fallback": true,
        "user_prioritization": true,
        "service_degradation_graceful": true,
        "notification_system": "activated"
      },
      "success_criteria": {
        "service_availability": 0.70,
        "critical_user_protection": 0.95,
        "recovery_time": 300
      }
    }
  ],
  "timeout_scenarios": [
    {
      "id": "timeout_1",
      "name": "Provider API timeout",
      "description": "External API not responding within timeout window",
      "scenario_config": {
        "provider": "openai",
        "model": "gpt-4",
        "simulated_delay": 45000,
        "timeout_threshold": 30000,
        "retry_attempts": 3
      },
      "expected_behavior": {
        "timeout_detection": true,
        "fallback_provider": "anthropic",
        "user_notification": "delay_warning",
        "circuit_breaker": "half_open"
      },
      "success_criteria": {
        "detection_time_ms": 30000,
        "fallback_success_rate": 0.90,
        "user_wait_time_ms": 35000
      }
    },
    {
      "id": "timeout_2",
      "name": "Complex query timeout",
      "description": "Long-running complex analysis exceeding time limits",
      "scenario_config": {
        "query_complexity": "very_high",
        "estimated_processing_time": 120000,
        "timeout_threshold": 60000,
        "allow_background_processing": true
      },
      "expected_behavior": {
        "background_processing": true,
        "progress_updates": true,
        "partial_results": true,
        "user_choice_continue": true
      },
      "success_criteria": {
        "background_completion_rate": 0.85,
        "partial_result_quality": 0.70,
        "user_satisfaction": "acceptable"
      }
    },
    {
      "id": "timeout_3",
      "name": "Network instability timeout",
      "description": "Intermittent network issues causing timeouts",
      "scenario_config": {
        "network_stability": 0.60,
        "connection_drops": 5,
        "retry_strategy": "exponential_backoff",
        "max_retry_time": 180000
      },
      "expected_behavior": {
        "intelligent_retry": true,
        "connection_pooling": true,
        "adaptive_timeout": true,
        "user_transparency": true
      },
      "success_criteria": {
        "eventual_success_rate": 0.80,
        "retry_efficiency": 0.75,
        "resource_conservation": "optimized"
      }
    }
  ],
  "high_memory_usage_patterns": [
    {
      "id": "memory_1",
      "name": "Large batch processing",
      "description": "Processing large batches of requests simultaneously",
      "scenario_config": {
        "batch_size": 100,
        "individual_request_size_kb": 50,
        "concurrent_batches": 10,
        "processing_duration_seconds": 300
      },
      "expected_behavior": {
        "memory_monitoring": true,
        "batch_size_adaptation": true,
        "garbage_collection": "aggressive",
        "resource_limits": "enforced"
      },
      "success_criteria": {
        "memory_usage_peak_mb": 2048,
        "processing_success_rate": 0.95,
        "system_stability": "maintained"
      }
    },
    {
      "id": "memory_2",
      "name": "Cache overflow scenario",
      "description": "Cache growing beyond configured limits",
      "scenario_config": {
        "cache_limit_mb": 512,
        "cache_growth_rate_mb_per_minute": 100,
        "eviction_policy": "LRU",
        "duration_minutes": 10
      },
      "expected_behavior": {
        "proactive_eviction": true,
        "cache_optimization": true,
        "memory_pressure_detection": true,
        "performance_degradation": "graceful"
      },
      "success_criteria": {
        "cache_hit_rate": 0.70,
        "memory_limit_compliance": true,
        "eviction_efficiency": 0.85
      }
    },
    {
      "id": "memory_3",
      "name": "Memory leak simulation",
      "description": "Gradual memory consumption increase over time",
      "scenario_config": {
        "leak_rate_mb_per_hour": 50,
        "duration_hours": 4,
        "detection_threshold_mb": 100,
        "mitigation_strategies": ["restart", "gc_force", "resource_limit"]
      },
      "expected_behavior": {
        "leak_detection": true,
        "automatic_mitigation": true,
        "service_health_monitoring": true,
        "alerting": "immediate"
      },
      "success_criteria": {
        "detection_time_minutes": 30,
        "mitigation_success_rate": 0.90,
        "service_uptime": 0.98
      }
    }
  ],
  "concurrent_user_scenarios": [
    {
      "id": "concurrent_1",
      "name": "Peak usage simulation",
      "description": "Maximum expected concurrent users",
      "scenario_config": {
        "concurrent_users": 1000,
        "session_duration_minutes": 30,
        "requests_per_user_per_minute": 2,
        "user_behavior": "mixed"
      },
      "expected_behavior": {
        "load_balancing": "active",
        "resource_scaling": "automatic",
        "performance_monitoring": "continuous",
        "user_experience": "consistent"
      },
      "success_criteria": {
        "response_time_p95_ms": 5000,
        "error_rate": 0.02,
        "resource_utilization": 0.80
      }
    },
    {
      "id": "concurrent_2",
      "name": "Sudden traffic spike",
      "description": "Unexpected rapid increase in user count",
      "scenario_config": {
        "baseline_users": 100,
        "spike_users": 1500,
        "spike_duration_minutes": 15,
        "spike_onset_seconds": 30
      },
      "expected_behavior": {
        "auto_scaling": "immediate",
        "traffic_shaping": "active",
        "service_protection": "enabled",
        "user_queueing": "intelligent"
      },
      "success_criteria": {
        "scaling_response_time_seconds": 120,
        "service_availability": 0.95,
        "user_wait_time_seconds": 10
      }
    }
  ],
  "error_recovery_scenarios": [
    {
      "id": "recovery_1",
      "name": "Database connection failure",
      "description": "Primary database becomes unavailable",
      "scenario_config": {
        "failure_duration_minutes": 10,
        "backup_available": true,
        "data_consistency_required": true,
        "user_sessions_active": 200
      },
      "expected_behavior": {
        "failover_to_backup": true,
        "session_preservation": true,
        "data_integrity": "maintained",
        "user_notification": "transparent"
      },
      "success_criteria": {
        "failover_time_seconds": 30,
        "session_loss_rate": 0.05,
        "data_consistency": true
      }
    },
    {
      "id": "recovery_2",
      "name": "Service dependency failure",
      "description": "Critical external service becomes unavailable",
      "scenario_config": {
        "failed_service": "auth_service",
        "failure_type": "complete_outage",
        "duration_minutes": 20,
        "fallback_options": ["cached_tokens", "guest_mode"]
      },
      "expected_behavior": {
        "graceful_degradation": true,
        "feature_limitation": "minimal",
        "user_communication": "clear",
        "recovery_automation": true
      },
      "success_criteria": {
        "service_availability": 0.70,
        "feature_preservation": 0.80,
        "recovery_success": true
      }
    }
  ]
}