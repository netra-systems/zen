<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="1" failures="12" skipped="0" tests="127" time="6.412" timestamp="2025-09-07T10:19:59.506973-07:00" hostname="Anthony"><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheBasics" name="test_cache_initialization" time="0.206" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheBasics" name="test_get_cache_key_generation" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheBasics" name="test_cache_and_retrieve_valid_payload" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheBasics" name="test_cache_and_retrieve_invalid_result" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheBasics" name="test_cache_expiration_removes_entries" time="1.102" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheBasics" name="test_jwt_token_expiration_handling" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheRedis" name="test_redis_cache_hit" time="0.006"><failure message="AssertionError: Expected 'get' to be called once. Called 0 times.">E   AssertionError: Expected 'get' to be called once. Called 0 times.

During handling of the above exception, another exception occurred:
E   AssertionError: Expected 'get' to be called once. Called 0 times.</failure></testcase><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheRedis" name="test_redis_cache_miss" time="0.004"><failure message="assert 0 &gt; 0">E   assert 0 &gt; 0</failure></testcase><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheRedis" name="test_redis_expired_token_removal" time="0.003"><failure message="AssertionError: Expected 'delete' to be called once. Called 0 times.">E   AssertionError: Expected 'delete' to be called once. Called 0 times.

During handling of the above exception, another exception occurred:
E   AssertionError: Expected 'delete' to be called once. Called 0 times.</failure></testcase><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheRedis" name="test_redis_connection_failure_fallback" time="0.002"><failure message="assert 0 &gt; 0">E   assert 0 &gt; 0</failure></testcase><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheRedis" name="test_redis_disabled_uses_memory_only" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCachePerformance" name="test_cache_size_limit_enforcement" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCachePerformance" name="test_expired_entries_cleanup_on_size_limit" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCachePerformance" name="test_get_cache_stats_accuracy" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCachePerformance" name="test_performance_under_concurrent_access" time="0.004" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheUserInvalidation" name="test_invalidate_user_cache_memory_only" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheUserInvalidation" name="test_invalidate_user_cache_with_redis" time="0.003" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheUserInvalidation" name="test_invalidate_user_cache_redis_failure_graceful" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheClearAndMaintenance" name="test_clear_cache_memory_only" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheClearAndMaintenance" name="test_clear_cache_with_redis" time="0.003" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheClearAndMaintenance" name="test_clear_cache_redis_failure_graceful" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheAsyncOperations" name="test_async_redis_cache_write" time="0.006" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheAsyncOperations" name="test_async_redis_cache_write_failure" time="0.014" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheEdgeCases" name="test_cache_with_none_payload" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheEdgeCases" name="test_cache_with_invalid_json_payload" time="0.001" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheEdgeCases" name="test_get_cache_stats_with_zero_validations" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheEdgeCases" name="test_cache_key_with_empty_token" time="0.001" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheEdgeCases" name="test_memory_cache_corruption_handling" time="0.002" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheGlobalInstance" name="test_global_instance_exists" time="0.001" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheGlobalInstance" name="test_global_instance_functionality" time="0.001" /><testcase classname="tests.unit.test_jwt_cache_comprehensive.TestJWTValidationCacheGlobalInstance" name="test_global_instance_stats" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_create_access_token" time="0.004" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_create_refresh_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_create_service_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_validate_valid_access_token" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_validate_invalid_token_type" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_validate_malformed_token" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_validate_expired_token" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_extract_user_id_from_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_extract_user_id_from_invalid_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_refresh_access_token_success" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_refresh_access_token_with_invalid_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_token_payload_contains_required_claims" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_token_issuer_is_correct" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_token_audience_is_correct" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBasics" name="test_token_jti_is_unique" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_blacklist_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_validate_blacklisted_token_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_remove_token_from_blacklist" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_blacklist_user" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_validate_token_for_blacklisted_user_fails" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_remove_user_from_blacklist" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerBlacklist" name="test_get_blacklist_info" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_token_with_none_algorithm_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_token_with_wrong_algorithm_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_token_with_invalid_issuer_fails" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_token_with_invalid_audience_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_token_too_old_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_token_issued_in_future_fails" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_id_token_basic" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_id_token_wrong_issuer_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_validate_id_token_expired_fails" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurity" name="test_mock_token_rejected_in_production" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerPerformance" name="test_get_performance_stats" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerPerformance" name="test_validate_token_caching" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerPerformance" name="test_token_structure_validation" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerPerformance" name="test_enhanced_jwt_claims_validation_fast" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_create_refresh_token_without_email" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_validate_token_for_consumption_with_replay_protection" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_cross_service_token_validation" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_service_signature_generation" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_cleanup_expired_token_ids" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_environment_binding_in_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_service_id_in_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_validate_token_jwt_alias" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_token_with_empty_permissions" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerEdgeCases" name="test_token_with_no_permissions" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecretManagement" name="test_get_jwt_secret_production_requires_secret" time="0.004" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecretManagement" name="test_get_jwt_secret_staging_requires_secret" time="0.003" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecretManagement" name="test_get_jwt_secret_production_requires_minimum_length" time="0.004" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecretManagement" name="test_get_jwt_secret_development_allows_empty" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecretManagement" name="test_get_jwt_secret_test_allows_empty" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_sync_blacklists_from_redis_success" time="0.020" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_load_blacklists_from_redis_success" time="0.004"><failure message="assert 0 &gt;= 2&#10; +  where 0 = len(set())&#10; +    where set() = &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x000001589596CE60&gt;._token_blacklist&#10; +      where &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x000001589596CE60&gt; = &lt;test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations object at 0x00000158944894F0&gt;.handler">E   assert 0 &gt;= 2
     +  where 0 = len(set())
     +    where set() = &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x000001589596CE60&gt;._token_blacklist
     +      where &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x000001589596CE60&gt; = &lt;test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations object at 0x00000158944894F0&gt;.handler</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_load_blacklists_from_redis_disabled" time="0.003" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_persist_token_blacklist_success" time="0.004"><failure message="AssertionError: Expected 'sadd' to have been called once. Called 0 times.">E   AssertionError: Expected 'sadd' to have been called once. Called 0 times.

During handling of the above exception, another exception occurred:
E   AssertionError: Expected 'sadd' to have been called once. Called 0 times.</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_persist_user_blacklist_success" time="0.003"><failure message="AssertionError: Expected 'sadd' to have been called once. Called 0 times.">E   AssertionError: Expected 'sadd' to have been called once. Called 0 times.

During handling of the above exception, another exception occurred:
E   AssertionError: Expected 'sadd' to have been called once. Called 0 times.</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_check_token_in_redis_found" time="0.016"><failure message="assert False is True">E   assert False is True</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_check_user_in_redis_not_found" time="0.011" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_run_async_in_background_with_running_loop" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAsyncOperations" name="test_run_async_in_background_without_loop" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_enhanced_jwt_claims_full" time="0.004"><error message="failed on setup with &quot;pytest.PytestUnraisableExceptionWarning: Exception ignored in: &lt;coroutine object TestJWTHandlerAsyncOperations.test_run_async_in_background_without_loop.&lt;locals&gt;.test_coro at 0x000001589455F7F0&gt;&#10;Enable tracemalloc to get traceback where the object was allocated.&#10;See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.&quot;">E   RuntimeWarning: coroutine 'TestJWTHandlerAsyncOperations.test_run_async_in_background_without_loop.&lt;locals&gt;.test_coro' was never awaited

The above exception was the direct cause of the following exception:
E   pytest.PytestUnraisableExceptionWarning: Exception ignored in: &lt;coroutine object TestJWTHandlerAsyncOperations.test_run_async_in_background_without_loop.&lt;locals&gt;.test_coro at 0x000001589455F7F0&gt;
    Enable tracemalloc to get traceback where the object was allocated.
    See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.</error></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_enhanced_jwt_claims_invalid_issuer" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_enhanced_jwt_claims_invalid_audience" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_enhanced_jwt_claims_environment_mismatch" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_enhanced_jwt_claims_service_id_mismatch" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_enhanced_jwt_claims_missing_jti_allowed" time="0.002"><failure message="assert False is True">E   assert False is True</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_cross_service_token_development_permissive" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_cross_service_token_future_issued" time="0.003" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_cross_service_token_too_old" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAdvancedValidation" name="test_validate_cross_service_token_with_replay_protection" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerTokenIdTracking" name="test_track_and_check_token_id" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerTokenIdTracking" name="test_cleanup_expired_token_ids_threshold" time="0.016" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerTokenIdTracking" name="test_cleanup_expired_token_ids_manual" time="0.002"><failure message="AssertionError: assert 100 == 0&#10; +  where 100 = len({'manual_token_17', 'manual_token_8', 'manual_token_52', 'manual_token_40', 'manual_token_2', 'manual_token_39', 'manual_token_85', 'manual_token_32', 'manual_token_96', 'manual_token_45', 'manual_token_16', 'manual_token_24', 'manual_token_21', 'manual_token_26', 'manual_token_76', 'manual_token_14', 'manual_token_3', 'manual_token_7', 'manual_token_87', 'manual_token_41', 'manual_token_63', 'manual_token_36', 'manual_token_58', 'manual_token_6', 'manual_token_57', 'manual_token_62', 'manual_token_51', 'manual_token_0', 'manual_token_66', 'manual_token_15', 'manual_token_93', 'manual_token_97', 'manual_token_94', 'manual_token_56', 'manual_token_86', 'manual_token_75', 'manual_token_5', 'manual_token_28', 'manual_token_25', 'manual_token_50', 'manual_token_70', 'manual_token_90', 'manual_token_64', 'manual_token_80', 'manual_token_1', 'manual_token_74', 'manual_token_34', 'manual_token_60', 'manual_token_9', 'manual_token_82', 'manual_token_65', 'manual_token_61', 'manual_token_35', 'manual_token_42', 'manual_token_46', 'manual_token_89', 'manual_token_19', 'manual_token_10', 'manual_token_98', 'manual_token_29', 'manual_token_13', 'manual_token_69', 'manual_token_83', 'manual_token_99', 'manual_token_44', 'manual_token_31', 'manual_token_68', 'manual_token_20', 'manual_token_43', 'manual_token_12', 'manual_token_4', 'manual_token_81', 'manual_token_67', 'manual_token_72', 'manual_token_38', 'manual_token_53', 'manual_token_55', 'manual_token_95', 'manual_token_30', 'manual_token_11', 'manual_token_48', 'manual_token_92', 'manual_token_23', 'manual_token_22', 'manual_token_73', 'manual_token_79', 'manual_token_91', 'manual_token_18', 'manual_token_88', 'manual_token_27', 'manual_token_47', 'manual_token_33', 'manual_token_59', 'manual_token_84', 'manual_token_54', 'manual_token_71', 'manual_token_77', 'manual_token_49', 'manual_token_37', 'manual_token_78'})&#10; +    where {'manual_token_17', 'manual_token_8', 'manual_token_52', 'manual_token_40', 'manual_token_2', 'manual_token_39', 'manual_token_85', 'manual_token_32', 'manual_token_96', 'manual_token_45', 'manual_token_16', 'manual_token_24', 'manual_token_21', 'manual_token_26', 'manual_token_76', 'manual_token_14', 'manual_token_3', 'manual_token_7', 'manual_token_87', 'manual_token_41', 'manual_token_63', 'manual_token_36', 'manual_token_58', 'manual_token_6', 'manual_token_57', 'manual_token_62', 'manual_token_51', 'manual_token_0', 'manual_token_66', 'manual_token_15', 'manual_token_93', 'manual_token_97', 'manual_token_94', 'manual_token_56', 'manual_token_86', 'manual_token_75', 'manual_token_5', 'manual_token_28', 'manual_token_25', 'manual_token_50', 'manual_token_70', 'manual_token_90', 'manual_token_64', 'manual_token_80', 'manual_token_1', 'manual_token_74', 'manual_token_34', 'manual_token_60', 'manual_token_9', 'manual_token_82', 'manual_token_65', 'manual_token_61', 'manual_token_35', 'manual_token_42', 'manual_token_46', 'manual_token_89', 'manual_token_19', 'manual_token_10', 'manual_token_98', 'manual_token_29', 'manual_token_13', 'manual_token_69', 'manual_token_83', 'manual_token_99', 'manual_token_44', 'manual_token_31', 'manual_token_68', 'manual_token_20', 'manual_token_43', 'manual_token_12', 'manual_token_4', 'manual_token_81', 'manual_token_67', 'manual_token_72', 'manual_token_38', 'manual_token_53', 'manual_token_55', 'manual_token_95', 'manual_token_30', 'manual_token_11', 'manual_token_48', 'manual_token_92', 'manual_token_23', 'manual_token_22', 'manual_token_73', 'manual_token_79', 'manual_token_91', 'manual_token_18', 'manual_token_88', 'manual_token_27', 'manual_token_47', 'manual_token_33', 'manual_token_59', 'manual_token_84', 'manual_token_54', 'manual_token_71', 'manual_token_77', 'manual_token_49', 'manual_token_37', 'manual_token_78'} = &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x00000158958583B0&gt;._used_token_ids&#10; +      where &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x00000158958583B0&gt; = &lt;test_jwt_handler_comprehensive.TestJWTHandlerTokenIdTracking object at 0x00000158944E2FF0&gt;.handler">E   AssertionError: assert 100 == 0
     +  where 100 = len({'manual_token_17', 'manual_token_8', 'manual_token_52', 'manual_token_40', 'manual_token_2', 'manual_token_39', 'manual_token_85', 'manual_token_32', 'manual_token_96', 'manual_token_45', 'manual_token_16', 'manual_token_24', 'manual_token_21', 'manual_token_26', 'manual_token_76', 'manual_token_14', 'manual_token_3', 'manual_token_7', 'manual_token_87', 'manual_token_41', 'manual_token_63', 'manual_token_36', 'manual_token_58', 'manual_token_6', 'manual_token_57', 'manual_token_62', 'manual_token_51', 'manual_token_0', 'manual_token_66', 'manual_token_15', 'manual_token_93', 'manual_token_97', 'manual_token_94', 'manual_token_56', 'manual_token_86', 'manual_token_75', 'manual_token_5', 'manual_token_28', 'manual_token_25', 'manual_token_50', 'manual_token_70', 'manual_token_90', 'manual_token_64', 'manual_token_80', 'manual_token_1', 'manual_token_74', 'manual_token_34', 'manual_token_60', 'manual_token_9', 'manual_token_82', 'manual_token_65', 'manual_token_61', 'manual_token_35', 'manual_token_42', 'manual_token_46', 'manual_token_89', 'manual_token_19', 'manual_token_10', 'manual_token_98', 'manual_token_29', 'manual_token_13', 'manual_token_69', 'manual_token_83', 'manual_token_99', 'manual_token_44', 'manual_token_31', 'manual_token_68', 'manual_token_20', 'manual_token_43', 'manual_token_12', 'manual_token_4', 'manual_token_81', 'manual_token_67', 'manual_token_72', 'manual_token_38', 'manual_token_53', 'manual_token_55', 'manual_token_95', 'manual_token_30', 'manual_token_11', 'manual_token_48', 'manual_token_92', 'manual_token_23', 'manual_token_22', 'manual_token_73', 'manual_token_79', 'manual_token_91', 'manual_token_18', 'manual_token_88', 'manual_token_27', 'manual_token_47', 'manual_token_33', 'manual_token_59', 'manual_token_84', 'manual_token_54', 'manual_token_71', 'manual_token_77', 'manual_token_49', 'manual_token_37', 'manual_token_78'})
     +    where {'manual_token_17', 'manual_token_8', 'manual_token_52', 'manual_token_40', 'manual_token_2', 'manual_token_39', 'manual_token_85', 'manual_token_32', 'manual_token_96', 'manual_token_45', 'manual_token_16', 'manual_token_24', 'manual_token_21', 'manual_token_26', 'manual_token_76', 'manual_token_14', 'manual_token_3', 'manual_token_7', 'manual_token_87', 'manual_token_41', 'manual_token_63', 'manual_token_36', 'manual_token_58', 'manual_token_6', 'manual_token_57', 'manual_token_62', 'manual_token_51', 'manual_token_0', 'manual_token_66', 'manual_token_15', 'manual_token_93', 'manual_token_97', 'manual_token_94', 'manual_token_56', 'manual_token_86', 'manual_token_75', 'manual_token_5', 'manual_token_28', 'manual_token_25', 'manual_token_50', 'manual_token_70', 'manual_token_90', 'manual_token_64', 'manual_token_80', 'manual_token_1', 'manual_token_74', 'manual_token_34', 'manual_token_60', 'manual_token_9', 'manual_token_82', 'manual_token_65', 'manual_token_61', 'manual_token_35', 'manual_token_42', 'manual_token_46', 'manual_token_89', 'manual_token_19', 'manual_token_10', 'manual_token_98', 'manual_token_29', 'manual_token_13', 'manual_token_69', 'manual_token_83', 'manual_token_99', 'manual_token_44', 'manual_token_31', 'manual_token_68', 'manual_token_20', 'manual_token_43', 'manual_token_12', 'manual_token_4', 'manual_token_81', 'manual_token_67', 'manual_token_72', 'manual_token_38', 'manual_token_53', 'manual_token_55', 'manual_token_95', 'manual_token_30', 'manual_token_11', 'manual_token_48', 'manual_token_92', 'manual_token_23', 'manual_token_22', 'manual_token_73', 'manual_token_79', 'manual_token_91', 'manual_token_18', 'manual_token_88', 'manual_token_27', 'manual_token_47', 'manual_token_33', 'manual_token_59', 'manual_token_84', 'manual_token_54', 'manual_token_71', 'manual_token_77', 'manual_token_49', 'manual_token_37', 'manual_token_78'} = &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x00000158958583B0&gt;._used_token_ids
     +      where &lt;auth_service.auth_core.core.jwt_handler.JWTHandler object at 0x00000158958583B0&gt; = &lt;test_jwt_handler_comprehensive.TestJWTHandlerTokenIdTracking object at 0x00000158944E2FF0&gt;.handler</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurityConsolidated" name="test_validate_token_security_consolidated_valid" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurityConsolidated" name="test_validate_token_security_consolidated_invalid_structure" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurityConsolidated" name="test_validate_jwt_structure_valid_token" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurityConsolidated" name="test_validate_jwt_structure_invalid_base64" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurityConsolidated" name="test_validate_jwt_structure_invalid_json" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerSecurityConsolidated" name="test_validate_jwt_structure_empty_parts" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerMockTokenSecurity" name="test_validate_token_rejects_mock_tokens" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerMockTokenSecurity" name="test_refresh_access_token_rejects_mock_tokens" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerMockTokenSecurity" name="test_mock_tokens_rejected_in_production_environment" time="0.005"><failure message="Failed: DID NOT RAISE &lt;class 'ValueError'&gt;">E   Failed: DID NOT RAISE &lt;class 'ValueError'&gt;</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerMockTokenSecurity" name="test_mock_tokens_rejected_in_test_environment_too" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAudienceMapping" name="test_get_audience_for_token_type_access" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAudienceMapping" name="test_get_audience_for_token_type_refresh" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAudienceMapping" name="test_get_audience_for_token_type_service" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAudienceMapping" name="test_get_audience_for_token_type_admin" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerAudienceMapping" name="test_get_audience_for_token_type_unknown" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerServiceSignature" name="test_generate_service_signature_success" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerServiceSignature" name="test_generate_service_signature_different_payloads" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerServiceSignature" name="test_generate_service_signature_handles_exceptions" time="0.002"><failure message="AssertionError: assert '9477526aa8ad2e85df328fe8bf0ad3c924d880fb3af61adfd84b914d20978304' == ''&#10;  &#10;  + 9477526aa8ad2e85df328fe8bf0ad3c924d880fb3af61adfd84b914d20978304">E   AssertionError: assert '9477526aa8ad2e85df328fe8bf0ad3c924d880fb3af61adfd84b914d20978304' == ''
      
      + 9477526aa8ad2e85df328fe8bf0ad3c924d880fb3af61adfd84b914d20978304</failure></testcase><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerInitializationAndConfig" name="test_handler_initialization_loads_config" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerInitializationAndConfig" name="test_handler_initialization_calls_redis_init" time="0.001" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerRefreshTokenEdgeCases" name="test_refresh_access_token_extracts_user_data_from_payload" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerRefreshTokenEdgeCases" name="test_refresh_access_token_with_minimal_refresh_token" time="0.002" /><testcase classname="tests.unit.test_jwt_handler_comprehensive.TestJWTHandlerIntegrationWithCache" name="test_blacklist_user_invalidates_cache" time="0.004" /></testsuite></testsuites>